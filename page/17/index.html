<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Matrix - CarlyleLiu‘s Blog</title><meta name="author" content="CarlyleLiu"><meta name="copyright" content="CarlyleLiu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CarlyleLiu’s Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Matrix">
<meta property="og:url" content="http://carlyleliu.vip/page/17/index.html">
<meta property="og:site_name" content="Matrix">
<meta property="og:description" content="CarlyleLiu’s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:author" content="CarlyleLiu">
<meta property="article:tag" content="Matrix">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://carlyleliu.vip/page/17/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":300},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Matrix',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-08-31 01:49:25'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Matrix" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">176</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://unsplash.it/1600/900?random')"><nav id="nav"><span id="blog-info"><a href="/" title="Matrix"><span class="site-name">Matrix</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Matrix</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/carlyleliu" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2019/Note/WirelessSummery/" title="无线相关概念"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;1581" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无线相关概念"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Note/WirelessSummery/" title="无线相关概念">无线相关概念</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-25T14:32:04.000Z" title="发表于 2019-03-25 22:32:04">2019-03-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Note/">Note</a></span></div><div class="content">
频谱划分

IEEE 802.11b/g 标准工作在 2.4G 频段，频率范围为 2.400—2.4835GHz，共 83.5M 带宽
划分为 14 个子信道
每个子信道宽度为 22MHz
相邻信道的中心频点间隔 5MHz
相邻的多个信道存在频率重叠（如 1 信道与 2、3、4、5 信道有频率重叠）
整个频段内只有 3 个（1、6、11）互不干扰信道


接收灵敏度

信道划分
2.4G 信道中国划分 802.11b 和 802.11g 的工作频段在 2.4GHz（2.4GHz-2.4835GHz），其可用带宽为 83.5MHz，中国划分为 13 个信道，每个信道带宽为 22MHz
北美/FCC 2.412-2.461GHz(11 信道） 欧洲/ETSI 2.412-2.472GHz(13 信道） 日本/ARIB 2.412-2.(14 信道）

SSID 和 BSSID
基本服务集（BSS）
基本服务集是 802.11 LAN 的基本组成模块。能互相进行无线通信的 STA 可以组成一个 BSS（Basic Service Set） 。如果一个站移出 BSS 的覆盖范围，它将不能再与 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/Literature/SuShi/" title="苏轼"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;9463" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="苏轼"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Literature/SuShi/" title="苏轼">苏轼</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-25T03:59:43.000Z" title="发表于 2019-03-25 11:59:43">2019-03-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Literature-Appreciation/">Literature Appreciation</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Literature-Appreciation/Poetry/">Poetry</a></span></div><div class="content">临江仙
夜饮东坡醒复醉，归来仿佛三更。家童鼻息已雷鸣。敲门都不应，倚杖听江声。
长恨此身非我有，何时忘却营营？夜阑风静縠纹平。小舟从此逝，江海寄余生。

西江月·世事一场大梦
世事一场大梦，人生几度秋凉？夜来风叶已鸣廊。看取眉头鬓上。
酒贱常愁客少，月明多被云妨。中秋谁与共孤光。把盏凄然北望。
江城子·乙卯正月二十日夜记梦
十年生死两茫茫，不思量，自难忘。
千里孤坟，无处话凄凉。
纵使相逢应不识，尘满面，鬓如霜。
夜来幽梦忽还乡，小轩窗，正梳妆。
相顾无言，惟有泪千行。
料得年年肠断处，明月夜，短松冈。
念奴娇·赤壁怀古
大江东去，浪淘尽，千古风流人物。
故垒西边，人道是，三国周郎赤壁。
乱石穿空，惊涛拍岸，卷起千堆雪。
江山如画，一时多少豪杰。
遥想公瑾当年，小乔初嫁了，雄姿英发。
羽扇纶巾，谈笑间，樯橹灰飞烟灭。
故国神游，多情应笑我，早生华发。
人生如梦，一尊还酹江月。
水龙吟·次韵章质夫杨花词
似花还似非花，也无人惜从教坠。抛家傍路，思量却是，无情有思。萦损柔肠，困酣娇眼，欲开还闭。梦随风万里，寻郎去处，又还被、莺呼起。
不恨此花飞尽，恨西园、落红难缀。晓来雨过，遗踪何在？一池 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/Debug/LinuxSystemStartOptimization/" title="Linux 启动优化"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;4533" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 启动优化"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Debug/LinuxSystemStartOptimization/" title="Linux 启动优化">Linux 启动优化</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-19T14:38:04.000Z" title="发表于 2019-03-19 22:38:04">2019-03-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/">Programming</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/Performance/">Performance</a></span></div><div class="content">启动流程
Linux 系统当前的启动流程如下：
1brom --&gt; boot0 --&gt; (monitor/secure os) --&gt; uboot --&gt; rootfs --&gt; app
brom 固化在 IC 内部，芯片出厂后就无法更改。后续将从 boot0 开始分阶段介绍启动优化的方法。
对于某些方案，会存在 monitor 或 secure os，这两者耗时很短，略过。

下文涉及到一些配置文件，提前在此说明。
env 配置文件路径：
123sdk/device/config/chips/&lt;chip&gt;/configs/&lt;board&gt;/linux/env-&lt;kernel-version&gt;.cfg #优先级高sdk/device/config/chips/&lt;chip&gt;/configs/default/env.cfg #优先级低sdk/target/allwinner/&lt;board&gt;/configs/env-&lt;kernel-version&gt;.cfg #旧 SDK
sys_config.f ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/Literature/LiQingzhao/" title="李清照"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;9364" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="李清照"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Literature/LiQingzhao/" title="李清照">李清照</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-18T03:59:43.000Z" title="发表于 2019-03-18 11:59:43">2019-03-18</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Literature-Appreciation/">Literature Appreciation</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Literature-Appreciation/Poetry/">Poetry</a></span></div><div class="content">一剪梅·红藕香残玉簟秋
红藕香残玉簟秋。轻解罗裳，独上兰舟。云中谁寄锦书来，雁字回时，月满西楼。
花自飘零水自流。一种相思，两处闲愁。此情无计可消除，才下眉头，却上心头。

如梦令·常记溪亭日暮
常记溪亭日暮，沉醉不知归路。
兴尽晚回舟，误入藕花深处。
争渡，争渡，惊起一滩鸥鹭。
如梦令·昨夜雨疏风骤
昨夜雨疏风骤，浓睡不消残酒。
试问卷帘人，却道海棠依旧。
知否，知否？应是绿肥红瘦。
醉花阴·薄雾浓云愁永昼
薄雾浓云愁永昼，瑞脑消金兽。佳节又重阳，玉枕纱橱，半夜凉初透。
东篱把酒黄昏后，有暗香盈袖。莫道不销魂，帘卷西风，人比黄花瘦。
南歌子·天上星河转
天上星河转，人间帘幕垂。凉生枕簟泪痕滋。起解罗衣聊问、夜何其。
翠贴莲蓬小，金销藕叶稀。旧时天气旧时衣。只有情怀不似、旧家时。
点绛唇·蹴罢秋千
蹴罢秋千，起来慵整纤纤手。露浓花瘦，薄汗轻衣透。
见客入来，袜刬金钗溜。和羞走，倚门回首，却把青梅嗅。
清平乐·年年雪里
年年雪里，常插梅花醉。挼尽梅花无好意，赢得满衣清泪。
今年海角天涯，萧萧两鬓生华。看取晚来风势，故应难看梅花。
武陵春·春晚
风住尘香花已尽，日晚倦梳头。物是人非事事休， ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/Literature/NorthIsland/" title="北岛的诗"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;232" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="北岛的诗"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Literature/NorthIsland/" title="北岛的诗">北岛的诗</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-14T03:59:43.000Z" title="发表于 2019-03-14 11:59:43">2019-03-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Literature-Appreciation/">Literature Appreciation</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Literature-Appreciation/Poetry/">Poetry</a></span></div><div class="content">😭北岛的长诗《白日梦》的第四节
你没有如期归来
而这正是离别的意义

一次爱的旅行
有时候就象抽烟那样
简单
地下室空守着你
内心的白银
水仙花在暗中灿然开放
你听凭所有的坏天气
发怒、哭喊
乞求你打开窗户
书页翻开
所有的文字四散
只留下一个数字
--我的座位号码
靠近窗户
本次列车的终点是你
😧过节（北岛）
毒蛇炫耀口中的钉子
大地有著毒蛇
吞吃鸟蛋的寂静
所有钟表
停止在无梦的时刻
丰收聚敛着
田野死后的笑容
从水银的镜子
影像成双的人们
乘家庭的轮子
去集市
一位本地英雄
在废弃的停车场上
唱歌
玻璃晴朗
桔子辉煌
😶‍🌫️回答（北岛）
卑鄙是卑鄙者的通行证，
高尚是高尚者的墓志铭，
看吧，在那镀金的天空中，
飘满了死者弯曲的倒影。
冰川纪过去了，
为什么到处都是冰凌？
好望角发现了，
为什么死海里千帆相竞？
我来到这个世界上，
只带着纸、绳索和身影，
为了在审判前，
宣读那些被判决的声音。
告诉你吧，世界
我——不——相——信！
纵使你脚下有一千名挑战者，
那就把我算作第一千零一名。
我不相信天是蓝的，
我不相信雷的回声，
我不相信梦是假的，
我不相信死无报应。
如果 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/Debug/LinuxSystemCropping/" title="Linux 系统裁剪"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;8124" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 系统裁剪"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Debug/LinuxSystemCropping/" title="Linux 系统裁剪">Linux 系统裁剪</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-09T14:38:04.000Z" title="发表于 2019-03-09 22:38:04">2019-03-09</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/">Programming</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/Performance/">Performance</a></span></div><div class="content">系统裁剪简介
固件中通常包含 boot0、 uboot、 kernel、 rootfs 等镜像。基于经验，各个镜像尺寸的量级如下表所示：



Image
size




boot0
&lt; 100k


uboot
&lt; 1M


kernel
3-15M


rootfs
&gt; 4M



可以看到 boot0、 uboot、 kernel、 rootfs 的尺寸是依次增大的。对于大尺寸的裁剪效果往往比小尺寸的裁剪效果明显，比如 rootfs 裁剪 1M 可能很容易，对于 uboot 来说，则非常困难。因此，后续主要介绍 kernel 以及 rootfs 的裁剪。

boot0 裁剪
由于 boot0 很小，通常来说 boot0 代码也不开源，因此略过。
uboot 裁剪
uboot 代码位于 sdk/vendor/brandy/u-boot 目录下，主要有下面两种裁剪思路：

修改 uboot 配置文件，删减不需要的配置。 uboot 配置文件通常位于源码下 include/configs/${CHIP}.h 或者 configs/${CHIP}_*_defconfi ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/Note/UserapaceBacktrace/" title="用户空间 backtrace"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;1054" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="用户空间 backtrace"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Note/UserapaceBacktrace/" title="用户空间 backtrace">用户空间 backtrace</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-01T18:22:04.000Z" title="发表于 2019-03-02 02:22:04">2019-03-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Note/">Note</a></span></div><div class="content">12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364#include &lt;execinfo.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#define MAX_FRAMES 10int myfunc1(int);int myfunc2(int);int myfunc3(int);void printCallers(){    int layers = 0, i = 0;    char ** symbols = NULL;        void * frames[MAX_FRAMES];    memset(frames, 0, sizeof(frames));    layers = backtrace(frames, MAX_FRAMES);    for (i=0; i&lt;l ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/Debug/LinuxMemoryOptimization/" title="Linux 内存优化"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;166" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 内存优化"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Debug/LinuxMemoryOptimization/" title="Linux 内存优化">Linux 内存优化</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-01T14:38:04.000Z" title="发表于 2019-03-01 22:38:04">2019-03-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/">Programming</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/Performance/">Performance</a></span></div><div class="content">内存使用情况分析
DRAM 大小
硬件上 DDR 确定之后， DRAM 大小就已经确定。
uboot 会根据 DRAM 驱动提供的接口获取 DRAM 的大小，然后修改 dts 中的 memory 节点，Linux 启动时解析 dts 获取 DRAM 的大小。 uboot 启动 log 中会打印 dram 的大小。比如 R329 方案 uboot 启动时会有如下 log：
1[01.300]DRAM: 128 MiB
执行： 123root@TinaLinux:/# hexdump -C /sys/firmware/devicetree/base/memory@40000000/reg00000000 00 00 00 00 40 00 00 00 00 00 00 00 08 00 00 00 |....@...........|00000010
也可以获取 dram 的起始地址与大小。如下面 R329 例子所示，其中 0x40000000 为起始地址， 0x08000000 为 dram 的 size.

系统内存使用情况
free 命令
进入 Linux 用户空间，执行 free  ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2019/Debug/LinuxPerf/" title="Linux 性能分析"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;5559" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linux 性能分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Debug/LinuxPerf/" title="Linux 性能分析">Linux 性能分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-03-01T14:38:04.000Z" title="发表于 2019-03-01 22:38:04">2019-03-01</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/">Technology Blog</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/">Programming</a><i class="fas fa-angle-right article-meta-link"></i><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Technology-Blog/Programming/Performance/">Performance</a></span></div><div class="content">cpu 使用分析
top 命令
1procps-ng-top -H -p 899 -w 120

-H 是线程模式
-p 指定进程 id
-w 指定显示宽度（列数）
-d 指定延时 ，屏幕更新间隔

shift+p 按照 cpu 使用率对线程排序。如下是一个实例：

123456789101112131415161718192021222324procps-ng-top - 10:11:13 up  1:00,  0 users,  load average: 3.90, 4.10, 3.89Threads:  81 total,   0 running,  81 sleeping,   0 stopped,   0 zombie%Cpu0  :  46.6/30.7   77[|||||||||||||||||||||||||||||||||||||||||            ]GiB Mem : 84.5/0.239    [                                                     ]GiB Swap:  0.0/0.000    ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2019/Note/LeakTracer/" title="Leaktrace 使用方法"><img class="post-bg" src="https://unsplash.it/1600/900?random&amp;4566" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Leaktrace 使用方法"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/Note/LeakTracer/" title="Leaktrace 使用方法">Leaktrace 使用方法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-02-26T18:22:04.000Z" title="发表于 2019-02-27 02:22:04">2019-02-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Note/">Note</a></span></div><div class="content">概述
LeakTracer 是在检查 C++ 程序内存泄漏时编写的一个小工具。我无法让 dmalloc 显示我想要的内容，我只看到了提到的 __builtin_return_address gcc-extension。
要使用 LeakTracer，请使用提供的 LeakCheck 脚本运行您的程序。它使用 LD_PRELOAD 特性在你的函数之上“覆盖”一些函数（不需要重新编译）。如果您的平台不支持 LD_PRELOAD，您可以将 LeakTracer.o 对象文件添加到 Makefile 中的对象并运行您的应用程序。
LeakTracer 利用 gdb 去输出发生内存泄露所发生的位置，它是通过 override operator new, operator delete, operator malloc, operator free 来实现检测。

用法
加载 leaktracer 库的 3 种方法：

将您的程序链接到 libleaktracer.a
将您的程序链接到 libleaktracer.so。您需要将 -lleaktracer 选项作为链接命令的第一个选项
使用 LD_ ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/16/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/#content-inner">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/#content-inner">18</a><a class="extend next" rel="next" href="/page/18/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">CarlyleLiu</div><div class="author-info__description">CarlyleLiu’s Blog</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">176</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/carlyleliu"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/carlyleliu" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/Embedded/EncryptionAlgorithm/" title="Encryption Algorithm"><img src="https://unsplash.it/1600/900?random&amp;2393" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Encryption Algorithm"/></a><div class="content"><a class="title" href="/2024/Embedded/EncryptionAlgorithm/" title="Encryption Algorithm">Encryption Algorithm</a><time datetime="2024-08-23T12:22:04.000Z" title="发表于 2024-08-23 20:22:04">2024-08-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/Embedded/SecureBoot/" title="Secure Boot"><img src="https://unsplash.it/1600/900?random&amp;7547" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Secure Boot"/></a><div class="content"><a class="title" href="/2024/Embedded/SecureBoot/" title="Secure Boot">Secure Boot</a><time datetime="2024-08-19T02:22:04.000Z" title="发表于 2024-08-19 10:22:04">2024-08-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/Embedded/TEESoftPipeLine/" title="TEE 软件交互流程"><img src="https://unsplash.it/1600/900?random&amp;4529" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TEE 软件交互流程"/></a><div class="content"><a class="title" href="/2024/Embedded/TEESoftPipeLine/" title="TEE 软件交互流程">TEE 软件交互流程</a><time datetime="2024-08-17T02:22:04.000Z" title="发表于 2024-08-17 10:22:04">2024-08-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/Embedded/RPMB/" title="RPMB 简介"><img src="https://unsplash.it/1600/900?random&amp;5677" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RPMB 简介"/></a><div class="content"><a class="title" href="/2024/Embedded/RPMB/" title="RPMB 简介">RPMB 简介</a><time datetime="2024-08-15T02:22:04.000Z" title="发表于 2024-08-15 10:22:04">2024-08-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/Embedded/TEEImplementationPrinciple/" title="TEE 实现原理"><img src="https://unsplash.it/1600/900?random&amp;8317" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TEE 实现原理"/></a><div class="content"><a class="title" href="/2024/Embedded/TEEImplementationPrinciple/" title="TEE 实现原理">TEE 实现原理</a><time datetime="2024-08-14T02:22:04.000Z" title="发表于 2024-08-14 10:22:04">2024-08-14</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Literature-Appreciation/"><span class="card-category-list-name">Literature Appreciation</span><span class="card-category-list-count">6</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Literature-Appreciation/Poetry/"><span class="card-category-list-name">Poetry</span><span class="card-category-list-count">6</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Note/"><span class="card-category-list-name">Note</span><span class="card-category-list-count">18</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Science-Thought/"><span class="card-category-list-name">Science Thought</span><span class="card-category-list-count">4</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Science-Thought/Math/"><span class="card-category-list-name">Math</span><span class="card-category-list-count">4</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Share/"><span class="card-category-list-name">Share</span><span class="card-category-list-count">4</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Share/Tools/"><span class="card-category-list-name">Tools</span><span class="card-category-list-count">4</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Technology-Blog/"><span class="card-category-list-name">Technology Blog</span><span class="card-category-list-count">144</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Design-Patters/" style="font-size: 1.1em; color: #999">Design Patters</a> <a href="/tags/Kernel/" style="font-size: 1.48em; color: #99a8bd">Kernel</a> <a href="/tags/IMU/" style="font-size: 1.14em; color: #999b9d">IMU</a> <a href="/tags/ARM64/" style="font-size: 1.1em; color: #999">ARM64</a> <a href="/tags/FOC/" style="font-size: 1.14em; color: #999b9d">FOC</a> <a href="/tags/ucos/" style="font-size: 1.1em; color: #999">ucos</a> <a href="/tags/Stabilization/" style="font-size: 1.23em; color: #999ea6">Stabilization</a> <a href="/tags/TEE/" style="font-size: 1.19em; color: #999da1">TEE</a> <a href="/tags/Memory/" style="font-size: 1.32em; color: #99a2ae">Memory</a> <a href="/tags/Note/" style="font-size: 1.39em; color: #99a5b4">Note</a> <a href="/tags/Task/" style="font-size: 1.23em; color: #999ea6">Task</a> <a href="/tags/Driver/" style="font-size: 1.41em; color: #99a5b7">Driver</a> <a href="/tags/C/" style="font-size: 1.3em; color: #99a1ac">C++</a> <a href="/tags/Odriver/" style="font-size: 1.14em; color: #999b9d">Odriver</a> <a href="/tags/Tools/" style="font-size: 1.17em; color: #999c9f">Tools</a> <a href="/tags/Poetry/" style="font-size: 1.21em; color: #999da4">Poetry</a> <a href="/tags/ISP/" style="font-size: 1.37em; color: #99a4b2">ISP</a> <a href="/tags/UAC/" style="font-size: 1.28em; color: #99a0aa">UAC</a> <a href="/tags/Sensor/" style="font-size: 1.12em; color: #999a9b">Sensor</a> <a href="/tags/Lens/" style="font-size: 1.17em; color: #999c9f">Lens</a> <a href="/tags/Robot/" style="font-size: 1.26em; color: #999fa8">Robot</a> <a href="/tags/3A/" style="font-size: 1.14em; color: #999b9d">3A</a> <a href="/tags/Interrupt/" style="font-size: 1.23em; color: #999ea6">Interrupt</a> <a href="/tags/Audio/" style="font-size: 1.26em; color: #999fa8">Audio</a> <a href="/tags/USB/" style="font-size: 1.34em; color: #99a3b0">USB</a> <a href="/tags/Debug/" style="font-size: 1.3em; color: #99a1ac">Debug</a> <a href="/tags/Links-Libraries/" style="font-size: 1.19em; color: #999da1">Links Libraries</a> <a href="/tags/EIS/" style="font-size: 1.12em; color: #999a9b">EIS</a> <a href="/tags/Linux/" style="font-size: 1.5em; color: #99a9bf">Linux</a> <a href="/tags/Actuator/" style="font-size: 1.23em; color: #999ea6">Actuator</a> <a href="/tags/FileSystem/" style="font-size: 1.17em; color: #999c9f">FileSystem</a> <a href="/tags/Performance/" style="font-size: 1.1em; color: #999">Performance</a> <a href="/tags/Programming/" style="font-size: 1.46em; color: #99a7bb">Programming</a> <a href="/tags/Math/" style="font-size: 1.17em; color: #999c9f">Math</a> <a href="/tags/Image/" style="font-size: 1.43em; color: #99a6b9">Image</a> <a href="/tags/RTOS/" style="font-size: 1.12em; color: #999a9b">RTOS</a> <a href="/tags/Linear-Algebra/" style="font-size: 1.17em; color: #999c9f">Linear Algebra</a> <a href="/tags/Refactor/" style="font-size: 1.14em; color: #999b9d">Refactor</a> <a href="/tags/ALSA/" style="font-size: 1.26em; color: #999fa8">ALSA</a> <a href="/tags/Motor/" style="font-size: 1.21em; color: #999da4">Motor</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">六月 2024</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">五月 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">四月 2024</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><span class="card-archive-list-count">6</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><span class="card-archive-list-count">4</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">176</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2024-08-30T17:49:24.886Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-08-30T17:49:24.886Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2024 By CarlyleLiu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js@2.1.0/dist/typed.umd.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["潦倒不通世务，愚顽怕读文章","天下无能第一，古今不肖无双"])
  } else {
    document.getElementById("subtitle").textContent = "潦倒不通世务，愚顽怕读文章"
  }
}
typedJSFn.run(subtitleType)</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>